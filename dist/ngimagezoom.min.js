!function(e,i,o){"use strict";o.module("imageZoom",[]),o.module("imageZoom").run(["$templateCache",function(e){e.put("zoom-control.html",'<div class="zoom-control__clip">\n    <img ng-src="{{imageSrc}}"/>\n    <div class="mark"></div>\n</div>\n'),e.put("zoom-image-container.html",'<div class="zoom-image-container__clip">\n    <img ng-src="{{imageSrc}}"/>\n</div>\n')}]),o.module("imageZoom").directive("zoomControl",["$rootScope",function(e){function i(i,t,n,r){function m(e){c(a(e))}function c(o){var t=i.markWidth,n=i.markHeight,r=o.x*l[0].clientWidth-.5*t,m=o.y*l[0].clientHeight-.5*n,c=l[0].clientHeight/i.markHeight,a=l[0].clientWidth/i.markWidth;u.css("left",r+"px").css("top",m+"px"),e.$broadcast("mark:moved",[{x:o.x*(1+a)-.5*a,y:o.y*(1+c)-.5*c}])}function a(e){return f=f||e.currentTarget.getBoundingClientRect(),{x:(e.clientX-f.left)/e.currentTarget.clientWidth,y:(e.clientY-f.top)/e.currentTarget.clientHeight}}var g=o.element,l=g(t[0].querySelector(".zoom-control__clip")),s=l.find("img"),u=g(l[0].querySelector(".mark")),d=s[0].naturalWidth,h=s[0].naturalHeight,f=u[0].getBoundingClientRect();i.imageSrc=r.getImageUrl(),i.imageContainerElem=r.getImageContainerElem(),i.imageContainerElemZoomed=i.imageContainerElem[0].querySelector(".zoom-image-container__clip"),i.$on("zoom-imagesrc:changed",function(e,o){i.imageSrc=o}),d&&h||s[0].addEventListener("load",function(o){var t;d=s[0].naturalWidth,h=s[0].naturalHeight,r.setOrigDimensions(d,h),i.imageContainerElem&&i.imageContainerElem.length>0&&(i.markWidth=i.imageContainerElemZoomed.clientWidth/d*l[0].clientWidth,t=i.imageContainerElemZoomed.clientWidth*(h/d),i.markHeight=t/h*l[0].clientHeight,e.$broadcast("zoom-image:loaded",t)),u.css("height",i.markHeight+"px").css("width",i.markWidth+"px"),c({x:.5,y:.5})}),l.on("mouseenter",function(e){c(a(e)),l.on("mousemove",m)}),l.on("mouseleave",function(e){l.off("mousemove",m)})}return{restrict:"A",require:"^zoom",scope:{},templateUrl:"zoom-control.html",link:i}}]),o.module("imageZoom").directive("zoomImageContainer",[function(){function e(e,i,t,n){function r(i){e.$apply(function(){a.css("left",(c[0].clientWidth-e.origDimensions.width)*i.x+"px").css("top",(c[0].clientHeight-e.origDimensions.height)*i.y+"px")})}var m=o.element,c=m(i[0].querySelector(".zoom-image-container__clip")),a=c.find("img");e.imageSrc=n.getImageUrl(),e.$on("zoom-image:loaded",function(i,o){e.origDimensions=n.getOrigDimensions(),c.css("height",o+"px")}),e.$on("mark:moved",function(e,i){r.apply(this,i)}),e.$on("zoom-imagesrc:changed",function(i,o){e.imageSrc=o}),t.$observe("ngSrc",function(i){e.imageSrc=t.ngSrc},!0),t.$observe("level",function(i){e.level=i},!0)}return{restrict:"A",require:"^zoom",scope:{},templateUrl:"zoom-image-container.html",link:e}}]),o.module("imageZoom").directive("zoom",["$rootScope",function(e){function i(i,t,n){var r=o.element;i.controlElem=r(t[0].querySelector("[zoom-control]")),i.imageContainerElem=r(t[0].querySelector("[zoom-image-container]")),n.$observe("zoomImagesrc",function(o){i.imageSrc=n.zoomImagesrc,e.$broadcast("zoom-imagesrc:changed",n.zoomImagesrc)},!0),n.$observe("level",function(e){i.level=e},!0)}return{restrict:"EA",scope:{imageSrc:"@zoomImagesrc"},link:i,controller:function(e){this.getImageUrl=function(){return e.imageSrc},this.getControlElem=function(){return e.controlElem},this.getImageContainerElem=function(){return e.imageContainerElem},this.setOrigDimensions=function(i,o){e.origWidth=i,e.origHeight=o},this.getOrigDimensions=function(){return{width:e.origWidth,height:e.origHeight}}}}}])}(window,document,window.angular);